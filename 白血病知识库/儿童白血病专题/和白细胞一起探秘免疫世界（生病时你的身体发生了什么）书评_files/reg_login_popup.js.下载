var account_pop={open:function(o,e){e?referrer="?referrer="+encodeURIComponent(e):referrer="?referrer="+window.location.href;var n="",i="",r=382;"reg"===o?(n="用户注册",i="https://accounts.douban.com/popup/login?source="+SOURCE+"#popup_register",r=480):"login"===o&&(n="用户登录",i="https://accounts.douban.com/popup/login?source="+SOURCE);var t=document.origin,c=dui.Dialog({width:478,title:n,height:r,cls:"account_pop",isHideTitle:!0,modal:!0,content:"<iframe scrolling='no' frameborder='0' width='478' height='"+r+"' src='"+i+"' name='"+t+"'></iframe>"},!0),a=c.node;if(a.off(),a.on("click",".dui-dialog-close",function(){var o=$("body");o.find("#login_msk").hide(),o.find(".account_pop").remove()}),$(window).width()<478){var d="";"reg"===o?d=HTTPS_DB+"/accounts/register"+referrer:"login"===o&&(d=HTTPS_DB+"/accounts/login"+referrer),window.location.href=d}else c.open();window.addEventListener("message",function(o){"https://accounts.douban.com"===o.origin&&(a.find("iframe").css("height",o.data),a.height(o.data),c.update())},!1)}};Douban&&Douban.init_show_login&&(Douban.init_show_login=function(o){var e=$(o);e.click(function(){var o=e.data("ref")||"";return account_pop.open("login",o),!1})});